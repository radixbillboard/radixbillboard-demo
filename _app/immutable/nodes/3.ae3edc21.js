import{V as T,F as q,W as $,X as K,s as X,f as v,a as w,g as C,h as E,c as y,d as f,j as N,i as g,w as b,J as Y,l as k,m as A,n as I,Y as V,L as h}from"../chunks/scheduler.764f6154.js";import{g as z,t as W,c as G,a as j,S as H,i as Q,b as U,d as Z,m as ee,e as te}from"../chunks/index.97486945.js";import{p as ne,S as se,b as P,a as ae,M as oe,c as J,d as re,n as le,V as ce,t as R,h as M,u as de,i as ue,j as ie,k as pe}from"../chunks/SendTransactionButton.1d77470f.js";import{j as _e}from"../chunks/radixDappToolkit.f15c70b5.js";function me(s,e){const i=e.token={};function c(n,t,_,a){if(e.token!==i)return;e.resolved=a;let o=e.ctx;_!==void 0&&(o=o.slice(),o[_]=a);const r=n&&(e.current=n)(o);let l=!1;e.block&&(e.blocks?e.blocks.forEach((d,m)=>{m!==t&&d&&(z(),W(d,1,1,()=>{e.blocks[m]===d&&(e.blocks[m]=null)}),G())}):e.block.d(1),r.c(),j(r,1),r.m(e.mount(),e.anchor),l=!0),e.block=r,e.blocks&&(e.blocks[t]=r),l&&K()}if(T(s)){const n=q();if(s.then(t=>{$(n),c(e.then,1,e.value,t),$(null)},t=>{if($(n),c(e.catch,2,e.error,t),$(null),!e.hasCatch)throw t}),e.current!==e.pending)return c(e.pending,0),!0}else{if(e.current!==e.then)return c(e.then,1,e.value,s),!0;e.resolved=s}}function O(s){let e,i,c=s[0].componentAddress+"",n,t,_,a=JSON.stringify(s[0].addresses,null,2)+"",o,r,l,d=JSON.stringify(s[0].config,null,2)+"",m;return{c(){e=v("pre"),i=k("Component address: "),n=k(c),t=w(),_=v("pre"),o=k(a),r=w(),l=v("pre"),m=k(d)},l(u){e=C(u,"PRE",{});var p=E(e);i=A(p,"Component address: "),n=A(p,c),p.forEach(f),t=y(u),_=C(u,"PRE",{});var B=E(_);o=A(B,a),B.forEach(f),r=y(u),l=C(u,"PRE",{});var S=E(l);m=A(S,d),S.forEach(f)},m(u,p){g(u,e,p),b(e,i),b(e,n),g(u,t,p),g(u,_,p),b(_,o),g(u,r,p),g(u,l,p),b(l,m)},p(u,p){p&1&&c!==(c=u[0].componentAddress+"")&&I(n,c),p&1&&a!==(a=JSON.stringify(u[0].addresses,null,2)+"")&&I(o,a),p&1&&d!==(d=JSON.stringify(u[0].config,null,2)+"")&&I(m,d)},d(u){u&&(f(e),f(t),f(_),f(r),f(l))}}}function fe(s){return{c:h,l:h,m:h,d:h}}function be(s){let e,i,c;return{c(){e=v("pre"),i=k("VirtualAccountAddress: "),c=k(s[5])},l(n){e=C(n,"PRE",{});var t=E(e);i=A(t,"VirtualAccountAddress: "),c=A(t,s[5]),t.forEach(f)},m(n,t){g(n,e,t),b(e,i),b(e,c)},d(n){n&&f(e)}}}function he(s){return{c:h,l:h,m:h,d:h}}function ge(s){let e,i,c,n,t,_,a=s[0]&&O(s),o={ctx:s,current:null,token:null,hasCatch:!1,pending:he,then:be,catch:fe,value:5};return me(ne.getVirtualAccountAddress(),o),t=new se({props:{text:"Buy All Blocks",buildManifestFn:s[3]}}),t.$on("transactionSucceeded",s[4]),{c(){e=v("div"),a&&a.c(),i=w(),o.block.c(),c=w(),n=v("div"),U(t.$$.fragment),this.h()},l(r){e=C(r,"DIV",{class:!0});var l=E(e);a&&a.l(l),i=y(l),o.block.l(l),c=y(l),n=C(l,"DIV",{class:!0});var d=E(n);Z(t.$$.fragment,d),d.forEach(f),l.forEach(f),this.h()},h(){N(n,"class","flex gap-4"),N(e,"class","flex flex-col gap-4 w-2/3 m-auto p-8")},m(r,l){g(r,e,l),a&&a.m(e,null),b(e,i),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=c,b(e,c),b(e,n),ee(t,n,null),_=!0},p(r,[l]){s=r,s[0]?a?a.p(s,l):(a=O(s),a.c(),a.m(e,i)):a&&(a.d(1),a=null)},i(r){_||(j(t.$$.fragment,r),_=!0)},o(r){W(t.$$.fragment,r),_=!1},d(r){r&&f(e),a&&a.d(),o.block.d(),o.token=null,o=null,te(t)}}}function ke(s,e,i){let c;const{currentBillboardComponent:n}=P;Y(s,n,o=>i(0,c=o));function t(o,r){var F;const l=(F=V(_e))==null?void 0:F.address,d=V(n),m=d.config,u=pe(o,r),p=ae(m.block_image_config),B=V(n).addresses.owner_badge_global_id.split(":"),S=B[0],x=B[1];return new oe().callMethod(l,"create_proof_of_non_fungibles",[J(S),re(ce.NonFungibleLocalId,le(x))]).callMethod(d.componentAddress,"update_config",[R(M(0),M(m.block_data_security_deposit_amount),p)]).callMethod(l,"withdraw",[J(d.xrdResourceAddress),M(0)]).takeAllFromWorktop(d.xrdResourceAddress,(L,D)=>L.callMethod(d.componentAddress,"buy_block",[R(de(u)),ue(D)])).callMethod(d.componentAddress,"update_config",[R(M(m.block_price_xrd),M(m.block_data_security_deposit_amount),p)]).callMethod(l,"deposit_batch",[ie("EntireWorktop")]).build()}return[c,n,t,()=>({manifest:t(0,9999),message:"Buy blocks"}),async()=>P.refreshComponent()]}class Be extends H{constructor(e){super(),Q(this,e,ke,ge,X,{})}}export{Be as component};
