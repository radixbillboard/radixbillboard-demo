import{V as x,F as D,W as y,X as T,s as q,f as C,a as B,g as E,h as M,c as w,d as f,j as R,i as k,w as h,J as L,l as v,m as A,n as I,Y as V,L as b}from"../chunks/scheduler.764f6154.js";import{g as X,t as O,c as Y,a as W,S as z,i as G,b as H,d as K,m as Q,e as U}from"../chunks/index.97486945.js";import{p as Z,S as ee,b as J,a as te,M as ne,c as P,d as g,t as F,u as se,h as ae,i as re,j as oe}from"../chunks/SendTransactionButton.85b33a23.js";import{j as ce}from"../chunks/radixDappToolkit.9efabee9.js";function le(s,e){const i=e.token={};function l(n,t,_,a){if(e.token!==i)return;e.resolved=a;let r=e.ctx;_!==void 0&&(r=r.slice(),r[_]=a);const o=n&&(e.current=n)(r);let c=!1;e.block&&(e.blocks?e.blocks.forEach((d,m)=>{m!==t&&d&&(X(),O(d,1,1,()=>{e.blocks[m]===d&&(e.blocks[m]=null)}),Y())}):e.block.d(1),o.c(),W(o,1),o.m(e.mount(),e.anchor),c=!0),e.block=o,e.blocks&&(e.blocks[t]=o),c&&T()}if(x(s)){const n=D();if(s.then(t=>{y(n),l(e.then,1,e.value,t),y(null)},t=>{if(y(n),l(e.catch,2,e.error,t),y(null),!e.hasCatch)throw t}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,s),!0;e.resolved=s}}function N(s){let e,i,l=s[0].componentAddress+"",n,t,_,a=JSON.stringify(s[0].addresses,null,2)+"",r,o,c,d=JSON.stringify(s[0].config,null,2)+"",m;return{c(){e=C("pre"),i=v("Component address: "),n=v(l),t=B(),_=C("pre"),r=v(a),o=B(),c=C("pre"),m=v(d)},l(u){e=E(u,"PRE",{});var p=M(e);i=A(p,"Component address: "),n=A(p,l),p.forEach(f),t=w(u),_=E(u,"PRE",{});var S=M(_);r=A(S,a),S.forEach(f),o=w(u),c=E(u,"PRE",{});var $=M(c);m=A($,d),$.forEach(f)},m(u,p){k(u,e,p),h(e,i),h(e,n),k(u,t,p),k(u,_,p),h(_,r),k(u,o,p),k(u,c,p),h(c,m)},p(u,p){p&1&&l!==(l=u[0].componentAddress+"")&&I(n,l),p&1&&a!==(a=JSON.stringify(u[0].addresses,null,2)+"")&&I(r,a),p&1&&d!==(d=JSON.stringify(u[0].config,null,2)+"")&&I(m,d)},d(u){u&&(f(e),f(t),f(_),f(o),f(c))}}}function de(s){return{c:b,l:b,m:b,d:b}}function ue(s){let e,i,l;return{c(){e=C("pre"),i=v("VirtualAccountAddress: "),l=v(s[5])},l(n){e=E(n,"PRE",{});var t=M(e);i=A(t,"VirtualAccountAddress: "),l=A(t,s[5]),t.forEach(f)},m(n,t){k(n,e,t),h(e,i),h(e,l)},d(n){n&&f(e)}}}function ie(s){return{c:b,l:b,m:b,d:b}}function pe(s){let e,i,l,n,t,_,a=s[0]&&N(s),r={ctx:s,current:null,token:null,hasCatch:!1,pending:ie,then:ue,catch:de,value:5};return le(Z.getVirtualAccountAddress(),r),t=new ee({props:{text:"Buy All Blocks",buildManifestFn:s[3]}}),t.$on("transactionSucceeded",s[4]),{c(){e=C("div"),a&&a.c(),i=B(),r.block.c(),l=B(),n=C("div"),H(t.$$.fragment),this.h()},l(o){e=E(o,"DIV",{class:!0});var c=M(e);a&&a.l(c),i=w(c),r.block.l(c),l=w(c),n=E(c,"DIV",{class:!0});var d=M(n);K(t.$$.fragment,d),d.forEach(f),c.forEach(f),this.h()},h(){R(n,"class","flex gap-4"),R(e,"class","flex flex-col gap-4 w-2/3 m-auto p-8")},m(o,c){k(o,e,c),a&&a.m(e,null),h(e,i),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=l,h(e,l),h(e,n),Q(t,n,null),_=!0},p(o,[c]){s=o,s[0]?a?a.p(s,c):(a=N(s),a.c(),a.m(e,i)):a&&(a.d(1),a=null)},i(o){_||(W(t.$$.fragment,o),_=!0)},o(o){O(t.$$.fragment,o),_=!1},d(o){o&&f(e),a&&a.d(),r.block.d(),r.token=null,r=null,U(t)}}}function _e(s,e,i){let l;const{currentBillboardComponent:n}=J;L(s,n,r=>i(0,l=r));function t(r,o){var S;const c=(S=V(ce))==null?void 0:S.address,d=V(n),m=d.config,u=oe(r,o),p=te(m.block_image_config);return new ne().callMethod(c,"create_proof_of_amount",[P(d.addresses.owner_badge_resource),g(1)]).callMethod(d.componentAddress,"update_config",[F(g(0),g(m.block_data_security_deposit_amount),p)]).callMethod(c,"withdraw",[P(d.xrdResourceAddress),g(0)]).takeAllFromWorktop(d.xrdResourceAddress,($,j)=>$.callMethod(d.componentAddress,"buy_block",[F(se(u)),ae(j)])).callMethod(d.componentAddress,"update_config",[F(g(m.block_price_xrd),g(m.block_data_security_deposit_amount),p)]).callMethod(c,"deposit_batch",[re("EntireWorktop")]).build()}return[l,n,t,()=>({manifest:t(0,9999),message:"Buy blocks"}),async()=>J.refreshComponent()]}class ke extends z{constructor(e){super(),G(this,e,_e,pe,q,{})}}export{ke as component};
